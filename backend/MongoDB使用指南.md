# MongoDB å®‰è£…å’Œä½¿ç”¨æŒ‡å—

## ğŸš€ 1. å®‰è£… MongoDB

### æ–¹æ³•ä¸€ï¼šMongoDB Community Serverï¼ˆæ¨èï¼‰
1. è®¿é—®ï¼šhttps://www.mongodb.com/try/download/community
2. é€‰æ‹© Windows ç‰ˆæœ¬ä¸‹è½½
3. è¿è¡Œå®‰è£…ç¨‹åºï¼Œé€‰æ‹© "Complete" å®‰è£…
4. å‹¾é€‰ "Install MongoDB as a Service"
5. å‹¾é€‰ "Install MongoDB Compass"ï¼ˆå›¾å½¢åŒ–ç•Œé¢ï¼‰

### æ–¹æ³•äºŒï¼šä½¿ç”¨ Dockerï¼ˆç®€å•ï¼‰
```bash
# æ‹‰å– MongoDB é•œåƒ
docker pull mongo:latest

# è¿è¡Œ MongoDB å®¹å™¨
docker run -d --name mongodb -p 27017:27017 -v mongodb_data:/data/db mongo:latest
```

## ğŸ–¥ï¸ 2. MongoDB Compass å›¾å½¢åŒ–ç•Œé¢ä½¿ç”¨

### è¿æ¥æ•°æ®åº“
1. æ‰“å¼€ MongoDB Compass
2. è¿æ¥å­—ç¬¦ä¸²ï¼š`mongodb://localhost:27017`
3. ç‚¹å‡» "Connect"

### æŸ¥çœ‹èŠå¤©æ•°æ®
1. **æ•°æ®åº“**: `chatbot_db`
2. **é›†åˆ**: 
   - `conversations` - å­˜å‚¨ä¼šè¯ä¿¡æ¯
   - `messages` - å­˜å‚¨æ¶ˆæ¯å†…å®¹

### å¸¸ç”¨æ“ä½œ
- **æŸ¥çœ‹ä¼šè¯åˆ—è¡¨**: ç‚¹å‡» `conversations` é›†åˆ
- **æŸ¥çœ‹æ¶ˆæ¯**: ç‚¹å‡» `messages` é›†åˆ
- **æœç´¢**: ä½¿ç”¨ Filter åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼š
  ```json
  {"conversation_id": "ä½ çš„ä¼šè¯ID"}
  ```
- **åˆ é™¤æ•°æ®**: é€‰ä¸­æ–‡æ¡£ï¼Œç‚¹å‡»åˆ é™¤å›¾æ ‡

## ğŸ”§ 3. å¯åŠ¨åº”ç”¨

### è®¾ç½®ç¯å¢ƒå˜é‡
ç¼–è¾‘ `backend/.env` æ–‡ä»¶ï¼š
```env
MONGODB_URL=mongodb://localhost:27017
MONGODB_DB_NAME=chatbot_db
```

### å¯åŠ¨åç«¯
```bash
cd backend
python main.py
```

## ğŸ“Š 4. æ•°æ®åº“ç»“æ„

### conversations é›†åˆç»“æ„
```json
{
  "_id": ObjectId("..."),
  "conversation_id": "ä¼šè¯å”¯ä¸€ID",
  "title": "ä¼šè¯æ ‡é¢˜",
  "models": ["ä½¿ç”¨çš„æ¨¡å‹åˆ—è¡¨"],
  "created_at": "åˆ›å»ºæ—¶é—´",
  "updated_at": "æ›´æ–°æ—¶é—´",
  "message_count": æ¶ˆæ¯æ•°é‡
}
```

### messages é›†åˆç»“æ„
```json
{
  "_id": ObjectId("..."),
  "conversation_id": "æ‰€å±ä¼šè¯ID",
  "role": "user/assistant",
  "content": "æ¶ˆæ¯å†…å®¹",
  "model": "æ¨¡å‹åç§°",
  "timestamp": "æ—¶é—´æˆ³",
  "created_at": "åˆ›å»ºæ—¶é—´"
}
```

## ğŸ› ï¸ 5. å¸¸è§é—®é¢˜è§£å†³

### è¿æ¥å¤±è´¥
1. ç¡®ä¿ MongoDB æœåŠ¡æ­£åœ¨è¿è¡Œ
2. æ£€æŸ¥ç«¯å£ 27017 æ˜¯å¦è¢«å ç”¨
3. ç¡®è®¤é˜²ç«å¢™è®¾ç½®

### æ•°æ®æœªä¿å­˜
1. æ£€æŸ¥æ—¥å¿—è¾“å‡º
2. ç¡®è®¤ç¯å¢ƒå˜é‡è®¾ç½®æ­£ç¡®
3. æ£€æŸ¥ MongoDB æœåŠ¡çŠ¶æ€

### æ€§èƒ½ä¼˜åŒ–
1. MongoDB Compass ä¸­æŸ¥çœ‹ç´¢å¼•ä½¿ç”¨æƒ…å†µ
2. æ ¹æ®æŸ¥è¯¢æ¨¡å¼åˆ›å»ºåˆé€‚çš„ç´¢å¼•
3. å®šæœŸæ¸…ç†è¿‡æœŸæ•°æ®

## ğŸ“‹ 6. MongoDB Compass ç•Œé¢è¯´æ˜

### ä¸»ç•Œé¢
- **å·¦ä¾§**: æ•°æ®åº“å’Œé›†åˆåˆ—è¡¨
- **ä¸­é—´**: æ–‡æ¡£æµè§ˆå™¨
- **å³ä¾§**: æ–‡æ¡£è¯¦æƒ…

### æŸ¥è¯¢åŠŸèƒ½
- **Filter**: è¿‡æ»¤æ¡ä»¶
- **Project**: é€‰æ‹©æ˜¾ç¤ºå­—æ®µ
- **Sort**: æ’åº
- **Limit**: é™åˆ¶ç»“æœæ•°é‡

### å®ç”¨åŠŸèƒ½
- **Export**: å¯¼å‡ºæ•°æ®
- **Import**: å¯¼å…¥æ•°æ®
- **Index**: ç®¡ç†ç´¢å¼•
- **Schema**: æŸ¥çœ‹æ•°æ®ç»“æ„

## ğŸ¯ 7. å¼€å‘è°ƒè¯•æŠ€å·§

### æŸ¥çœ‹æœ€è¿‘çš„ä¼šè¯
```json
// åœ¨ conversations é›†åˆçš„ Filter ä¸­è¾“å…¥
{"updated_at": {"$gte": "2025-06-15"}}
```

### æŸ¥çœ‹ç‰¹å®šç”¨æˆ·çš„æ¶ˆæ¯
```json
// åœ¨ messages é›†åˆçš„ Filter ä¸­è¾“å…¥
{"role": "user", "timestamp": {"$gte": "2025-06-15T00:00:00"}}
```

### ç»Ÿè®¡æ¶ˆæ¯æ•°é‡
ç‚¹å‡» "Aggregations" æ ‡ç­¾ï¼Œåˆ›å»ºèšåˆç®¡é“
